<!DOCTYPE html>
{% load static %}
<html lang="en" dir="ltr" data-startbar="light" data-bs-theme="light">

<head>
    <meta charset="utf-8" />
    <title>School | {% block title %}{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta content="School Manager" name="description" />
    <meta content="" name="author" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- App favicon -->
    <link rel="shortcut icon" href="{% static 'school_manager/assets/images/favicon.ico' %}">
    <link rel="stylesheet" href="{% static 'school_manager/assets/libs/jsvectormap/css/jsvectormap.min.css' %}">
     <!-- App css -->
     <link href="{% static 'school_manager/assets/css/bootstrap.min.css' %}" rel="stylesheet" type="text/css" />
     <link href="{% static 'school_manager/assets/css/icons.min.css' %}" rel="stylesheet" type="text/css" />
     <link href="{% static 'school_manager/assets/css/app.min.css' %}" rel="stylesheet" type="text/css" />
    {% block extra_css %} 
    {% endblock %} 
    {% block extra_javascript %} 
    {% endblock %} 
</head>
<body>
    <!-- Top Bar Start -->
    <div id="topbar" class="sticky top-0 z-30 flex items-center justify-between bg-white shadow px-4 py-2 d-print-none">
        <div class="flex items-center space-x-2">
            <button id="btn-toggle-startbar" class="md:hidden text-gray-600">
                <i data-lucide="menu"></i>
            </button>
            <img src="{{ request.ecole.logo.url }}" alt="{{ request.ecole.nom }}" class="h-10 w-10 rounded" />
            <h1 class="text-lg font-semibold">{{ request.ecole.nom }}</h1>
            <a href="{% url 'comptes:choisir_ecole' %}" class="ml-2 text-sm text-blue-600 hover:underline">Changer d’école</a>
        </div>
        <form action="#" method="get" class="hidden md:block flex-1 mx-4">
            <input type="search" name="q" placeholder="Recherche rapide..." class="w-full rounded border border-gray-300 px-2 py-1" />
        </form>
        <div class="relative">
            <button id="user-menu-btn" class="flex items-center focus:outline-none">
                <i data-lucide="user" class="w-8 h-8"></i>
                <i data-lucide="chevron-down" class="w-4 h-4 ml-1"></i>
            </button>
            <div id="user-menu" class="absolute right-0 mt-2 w-48 bg-white border rounded shadow-lg hidden">
                <a href="{% url 'comptes:profil' %}" class="block px-4 py-2 hover:bg-gray-100">Profil</a>
                {% if request.user.is_superuser %}
                <a href="{% url 'admin:index' %}" class="block px-4 py-2 hover:bg-gray-100">Paramètres</a>
                {% endif %}
                <a href="{% url 'comptes:logout' %}" class="block px-4 py-2 hover:bg-gray-100">Déconnexion</a>
            </div>
        </div>
    </div>
    <!-- Startbar Menu -->
    <aside id="startbar-menu" class="fixed inset-y-0 left-0 w-64 bg-white shadow-lg transform -translate-x-full md:translate-x-0 transition-transform duration-200 overflow-y-auto scrollbar-thin d-print-none">
        <nav class="pt-4 pb-8 border-l-4" style="border-color: {{ request.ecole.theme_color }};">
            <ul class="space-y-1">
                <li>
                    <a href="{% url 'dashboard' %}" class="flex items-center gap-3 px-4 py-2 hover:bg-gray-100">
                        <i data-lucide="layout-dashboard" class="w-5 h-5"></i>
                        <span class="hidden md:inline">Tableau de bord</span>
                    </a>
                </li>
                {% if request.user.role == 'admin_ecole' or request.user.role == 'superadmin' %}
                <li>
                    <a href="{% url 'eleves:index' %}" class="flex items-center gap-3 px-4 py-2 hover:bg-gray-100">
                        <i data-lucide="users" class="w-5 h-5"></i>
                        <span class="hidden md:inline">Élèves</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'classes:index' %}" class="flex items-center gap-3 px-4 py-2 hover:bg-gray-100">
                        <i data-lucide="layers" class="w-5 h-5"></i>
                        <span class="hidden md:inline">Classes</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'cours:index' %}" class="flex items-center gap-3 px-4 py-2 hover:bg-gray-100">
                        <i data-lucide="book-open" class="w-5 h-5"></i>
                        <span class="hidden md:inline">Cours</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'finance:paiements' %}" class="flex items-center gap-3 px-4 py-2 hover:bg-gray-100">
                        <i data-lucide="wallet" class="w-5 h-5"></i>
                        <span class="hidden md:inline">Finance</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'presence:index' %}" class="flex items-center gap-3 px-4 py-2 hover:bg-gray-100">
                        <i data-lucide="calendar-check" class="w-5 h-5"></i>
                        <span class="hidden md:inline">Présence</span>
                    </a>
                </li>
                {% endif %}
                {% if request.user.role == 'prof' %}
                <li>
                    <a href="{% url 'mes-cours' %}" class="flex items-center gap-3 px-4 py-2 hover:bg-gray-100">
                        <i data-lucide="notebook" class="w-5 h-5"></i>
                        <span class="hidden md:inline">Mes cours</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'notes:index' %}" class="flex items-center gap-3 px-4 py-2 hover:bg-gray-100">
                        <i data-lucide="pencil" class="w-5 h-5"></i>
                        <span class="hidden md:inline">Notes</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'presence:prise' %}" class="flex items-center gap-3 px-4 py-2 hover:bg-gray-100">
                        <i data-lucide="check-square" class="w-5 h-5"></i>
                        <span class="hidden md:inline">Présence</span>
                    </a>
                </li>
                {% endif %}
                {% if request.user.role == 'parent' or request.user.role == 'eleve' %}
                <li>
                    <a href="{% url 'mes-notes' %}" class="flex items-center gap-3 px-4 py-2 hover:bg-gray-100">
                        <i data-lucide="award" class="w-5 h-5"></i>
                        <span class="hidden md:inline">Mes résultats</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'mes-factures' %}" class="flex items-center gap-3 px-4 py-2 hover:bg-gray-100">
                        <i data-lucide="file-text" class="w-5 h-5"></i>
                        <span class="hidden md:inline">Factures</span>
                    </a>
                </li>
                {% endif %}
            </ul>
        </nav>
    </aside>

    <div class="page-wrapper">

        <!-- Page Content-->
        <div class="page-content">
            <div class="container-xxl">
              {% block content %} 
              {% endblock %} 
            </div><!-- container -->

            <!--Start Rightbar-->
            <!--Start Rightbar/offcanvas-->
            <div class="offcanvas offcanvas-end" tabindex="-1" id="Appearance" aria-labelledby="AppearanceLabel">
                <div class="offcanvas-header border-bottom justify-content-between">
                  <h5 class="m-0 font-14" id="AppearanceLabel">Appearance</h5>
                  <button type="button" class="btn-close text-reset p-0 m-0 align-self-center" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                </div>
                <div class="offcanvas-body">  
                    <h6>Account Settings</h6>
                    <div class="p-2 text-start mt-3">
                        <div class="form-check form-switch mb-2">
                            <input class="form-check-input" type="checkbox" id="settings-switch1">
                            <label class="form-check-label" for="settings-switch1">Auto updates</label>
                        </div><!--end form-switch-->
                        <div class="form-check form-switch mb-2">
                            <input class="form-check-input" type="checkbox" id="settings-switch2" checked>
                            <label class="form-check-label" for="settings-switch2">Location Permission</label>
                        </div><!--end form-switch-->
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="settings-switch3">
                            <label class="form-check-label" for="settings-switch3">Show offline Contacts</label>
                        </div><!--end form-switch-->
                    </div><!--end /div-->
                    <h6>General Settings</h6>
                    <div class="p-2 text-start mt-3">
                        <div class="form-check form-switch mb-2">
                            <input class="form-check-input" type="checkbox" id="settings-switch4">
                            <label class="form-check-label" for="settings-switch4">Show me Online</label>
                        </div><!--end form-switch-->
                        <div class="form-check form-switch mb-2">
                            <input class="form-check-input" type="checkbox" id="settings-switch5" checked>
                            <label class="form-check-label" for="settings-switch5">Status visible to all</label>
                        </div><!--end form-switch-->
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="settings-switch6">
                            <label class="form-check-label" for="settings-switch6">Notifications Popup</label>
                        </div><!--end form-switch-->
                    </div><!--end /div-->               
                </div><!--end offcanvas-body-->
            </div>
            <!--end Rightbar/offcanvas-->
            <!--end Rightbar-->
            <!--Start Footer-->
            
            <footer class="footer text-center text-sm-start d-print-none">
                <div class="container-xxl">
                    <div class="row">
                        <div class="col-12">
                            <div class="card mb-0 rounded-bottom-0">
                                <div class="card-body">
                                    <p class="text-muted mb-0">
                                        ©
                                        <script> document.write(new Date().getFullYear()) </script>
                                        School Manager
                                        <span
                                            class="text-muted d-none d-sm-inline-block float-end">
                                            Crafted with
                                            <i class="iconoir-heart text-danger"></i>
                                            by Love</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </footer>

            <!--end footer-->
        </div>
        <!-- end page content -->
    </div>
    {% block param %} 
    {% endblock %} 
    <!-- end page-wrapper -->
    <script src="{% static 'school_manager/assets/libs/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'school_manager/assets/libs/simplebar/simplebar.min.js' %}"></script>

    <script src="{% static 'school_manager/assets/libs/apexcharts/apexcharts.min.js' %}"></script>
    <script src="{% static 'school_manager/assets/data/stock-prices.js' %}"></script>
    <script src="{% static 'school_manager/assets/libs/jsvectormap/js/jsvectormap.min.js' %}"></script>
    <script src="{% static 'school_manager/assets/libs/jsvectormap/maps/world.js' %}"></script>
    <script src="{% static 'school_manager/assets/js/pages/index.init.js' %}"></script>
    <script src="{% static 'school_manager/assets/js/app.js' %}"></script>
    <script>
        $(function() {
            $('#btn-toggle-startbar').on('click', function(e) {
                e.preventDefault();
                $('#startbar-menu').toggleClass('-translate-x-full');
            });
            $('#user-menu-btn').on('click', function(e) {
                e.stopPropagation();
                $('#user-menu').toggleClass('hidden');
            });
            $(document).on('click', function(e) {
                if (!$(e.target).closest('#user-menu').length && !$(e.target).closest('#user-menu-btn').length) {
                    $('#user-menu').addClass('hidden');
                }
            });
        });
    </script>
    {% block javascript %} 
    {% endblock %}
</body>
</html>